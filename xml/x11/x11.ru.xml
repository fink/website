<?xml version = '1.0' encoding = 'utf-8'?>
<!DOCTYPE document SYSTEM "../finkdoc.dtd">
<document filename="index" lang="ru">
    <title>Использование X11 в Darwin и Mac OS X</title>
    <shorttitle>Использование X11</shorttitle>
    <cvsid>$Id: x11.ru.xml,v 1.6 2023/08/04 5:08:13 nieder Exp $</cvsid>
    <preface>
        <p> Данный документ посвящен использованию X11 / XFree86 / Xtools в Mac
            OS X и Darwin Apple. В нем вы найдете введение, историю создания продукта, а также отражение
            текущей ситуации и множества
            имеющихся возможностей для применения  X11 как с Fink, так и иным образом.</p>
    </preface>
    <chapter filename="intro">
        <title>Введение</title>
        <shorttitle>Введение</shorttitle>
        <section name="def-x11">
            <title>Что такое X11?</title>
            <p> <link url="http://www.x.org/">X Window System</link>, версия
                11 (или сокращенно X11) является системой графического отображения с
                прозрачной для сети архитектурой клиент-сервер. Она позволяет
                приложениям графически создавать на экране пиксели, линии, тексты, изображения и т.п.
                X11 также имеет дополнительные библиотеки, благодаря которым
                приложения могут свободно рисовать интерфейсы пользователя - кнопки, поля для текста и
                т.п.</p>
            <p> X11 фактически является стандартной системой графического отображения в мире Unix.
                Она поставляется вместе с Linux, *BSD и большинством коммерческих вариантов Unix.
                На ее основе работают такие виды среды рабочего стола, как CDE, KDE и GNOME.</p>
        </section>
        <section name="def-macosx">
            <title>Что такое Mac OS X?</title>
            <p>
                <link url="http://www.apple.com/macosx/">Mac OS X</link> - операционная система,
                производителем которой является <link
                    url="http://www.apple.com/">Apple</link>. Как и
                предшествующие NeXTStep и OpenStep, она основана на BSD и таким образом
                входит в семейство операционных систем Unix. Но при этом она выпускается с
                системой графического отображения, являющейся частной собственностью. Графический процессор
                называется Quartz, а интерфейс Aqua, хотя оба названия
                часто используются как взаимозаменяемые.</p>
        </section>
        <section name="def-darwin">
            <title>Что такое Darwin?</title>
            <p>
                <link url="http://opendarwin.org/">Darwin</link> по сути является
                упрощенной версией Mac OS X, которую можно получить бесплатно
                с полным исходным кодом. Она не содержит Quartz,
                Aqua и прочую сопутствующую технологию. По умолчанию она предлагает только
                текстовую консоль.</p>
        </section>
        <section name="def-xfree86">
            <title>Что такое XFree86?</title>
            <p>
                <link url="http://www.xfree86.org/">XFree86</link> - реализация X11
                на основе исходного кода. Первоначально она была разработана для применения на
                ПК Intel x86, отсюда и ее название. В настоящее время применяется во многих архитектурах
                и операционных системах, в т.ч. OS/2, Darwin, Mac
                OS X и Windows.</p>
        </section>
        <section name="def-xtools">
            <title>Что такое Xtools?</title>
            <p> Xtools - продукт <link url="http://www.tenon.com/">Tenon
                Intersystems</link>. Это версия X11 для Mac OS X, основанная на
                XFree86.</p>
        </section>
        <section name="client-server">
            <title>Клиент и сервер</title>
            <p> X11 имеет архитектуру клиент-сервер. Есть одна центральная программа,
                которая фактически создает графику и координирует доступ через
                несколько приложений; это сервер. Приложение, желающее
                создать графику с применением X11, соединяется с сервером и дает указание, что именно надо
                нарисовать. В контексте X11 приложения называются клиентами.</p>
            <p> X11 позволяет серверу и клиентам находиться на разных машинах,
                в результате чего часто происходит путаница в терминах. В среде
                с рабочими станциями и серверами вы будете использовать сервер отображения X11
                на машине рабочей станции, а приложения
                (клиенты X) - на машине сервера. Таким образом, говоря
                &quot;сервер&quot;, вы имеем в виду программу сервера отображения X11,
                а не машину, спрятанную в вашем шкафу. </p>
        </section>
        <section name="rootless">
            <title>Что означает "бескорневой" ("rootless")?</title>
            <p> Немного предыстории: X11 моделирует экран в виде иерархии окон,
                находящихся одно в другом. В верхней части иерархии находится специальное окно
                размером с экран, вмещающее все другие
                окна. Оно содержит фон рабочего стола
                и называется &quot;корневым окном&quot;.</p>
            <p> Теперь вернемся к нашей теме: Как и любая графическая среда, X11 написана
                для самостоятельной работы и полного управления экраном. В
                Mac OS X Quartz уже управляет экраном, т. обр. для одновременной работы обеих систем
                надо совершить определенные действия.</p>
            <p> Одно из возможных действий - позволить системам работать поочередно. Каждая среда
                получает в распоряжение весь экран, но в определенный момент времени видна только одна из них
                и пользователь может перемещаться между ними. Это
                называется полноэкранным или корневым режимом. Корневым - потому что есть
                абсолютно нормальное корневое окно на экране  X11, работающее также, как
                и в других системах.</p>
            <p> Другое действие - комбинирование окон двух видов среды.
                Это устраняет необходимость перемещения между экранами, а также
                избавляет от корневого окна X11, т.к. Quartz уже берет на себя заботу о
                фоне рабочего стола. Поскольку нет
                корневого (видимого)  окна, данный режим называется
                &quot;бескорневым&quot;. Это наиболее удобный способ
                использования X11в Mac OS X.</p>
        </section>
        <section name="wm">
            <title>Что такое менеджер окон?</title>
            <p> В большинстве видов графической среды вид рамок окон (строка
                заголовка, кнопка закрытия и т.д.) определяется системой. В X11 это
                решается иначе. Рамки окон (также называемые &quot;декоративными обрамлениями&quot;) в X11
                обеспечиваются отдельной программой -
                менеджером окон. Во многих отношениях менеджер окон
                является просто еще одним клиентом; он запускается
                и общается с сервером X через те же каналы.</p>
            <p> Существует большой выбор разных менеджеров окон.
                    На сайте <link url="http://www.xwinman.org/">xwinman.org</link>
                имеется исчерпывающий список. Наиболее популярные из них позволяют пользователю
                настроить вид через т. наз. <link
                url="http://www.themes.org/">темы</link>. Многие менеджеры окон также
                обеспечивают такие дополнительные функции, как всплывающие меню в
                корневом окне, стыковки и кнопки запуска.</p>
            <p> Для Fink скомпилированы многие менеджеры окон  - см. <link
                    url="http://pdb.finkproject.org/pdb/section.php/x11-wm">
                    текущий список.</link>
            </p>
        </section>
        <section name="desktop">
            <title>Что такое Quartz/Aqua, Gnome и KDE?</title>
            <p> Это виды среды рабочего стола, в числе многих других. Их цель -
                обеспечение дополнительных границ для приложений, чтобы
                их вид и поведение были визуально последовательными. Пример:</p>
            <p> графический процессор : X11</p>
            <p> менеджер окон : <link url="http://sawmill.sourceforge.net/">sawfish</link>
            </p>
            <p> рабочий стол : <link url="http://www.gnome.org/">Gnome</link>
            </p>
            <p> Границы между графическим процессором, менеджером окон и рабочим
                столом размыты, т.к. схожая или одинаковая функция
                может быть реализована одним или несколькими из них. Это одна из причин того, почему
                отдельный менеджер окон может не работать с отдельной
                средой рабочего стола.</p>
            <p> Многие приложения разработаны для интеграции с отдельным рабочим столом.
                Чаще всего после инсталляции библиотек среды рабочего стола
                (и других базовых библиотек) разработанное для данной среды приложение
                работает с небольшими функциональными потерями или вовсе
                без них. Примером служит растущий <link
                    url="http://pdb.finkproject.org/pdb/section.php/gnome">
                    выбор приложений GNOME</link>, которые можно
                инсталлировать и использовать без применения GNOME. К сожалению,
                    это <link
                    url="/faq/usage-fink.php#kde">
                    достижение пока не распространяется </link>на <link
                    url="http://www.kde.org/">приложения KDE.</link>
            </p>
        </section>
    </chapter>
    <chapter filename="history">
        <title>История создания продукта</title>
        <shorttitle>История</shorttitle>
        <preface>
            <p>[Извините за эпический стиль, не смог устоять...]</p>
        </preface>
        <section name="early">
            <title>Отрочество</title>
            <p> Вначале не было ничего. Darwin только появилась на свет, Mac
                OS X находилась на стадии разработки, а X11 еще не была создана.
            </p>
            <p> Затем появился Джон Кармак и перенес XFree86 в Mac OS X Server,
                которая была единственной на тот момент операционной системой в семействе Darwin.
                Впоследствии Дейв Зарзыки адаптировал этот перенос для XFree86 4.0 и
                Darwin 1.0 . Патчи нашли свое место в хранилище CVS
                Darwin и оставались там в ожидании грядущих событий.</p>
        </section>
        <section name="xonx-forms">
            <title>Формы XonX</title>
            <p> В один прекрасный день появился Торри Т. Лайонс и патчам Darwin
                было наконец уделено внимание, которого они так ждали. Наконец-то он
                перенес их в их новый дом - официальное хранилище CVS XFree86.
                Это было время, когда Mac OS X Public Beta и Darwin 1.2.
                XFree86 4.0.2 прекрасно работали в Darwin, но Mac OS X требовала, чтобы
                пользователи завершали работу в Aqua и переходили к консоли для выполнения действий.
                Торри собрал вокруг себя <link url="http://mrcla.com/XonX/">команду XonX
                </link> и отправился в путешествие, чтобы доставить XFree86
                в Mac OS X.</p>
            <p> Примерно в то же время Tenon начала построение Xtools с использованием
                XFree86 4.0 в качестве основы.</p>
        </section>
        <section name="root-or-not">
            <title>Быть иль не быть корневым?</title>
            <p> Вскоре команда XonX добилась реализации XFree86 в полноэкранном режиме
                параллельно Quartz и предоставляла пробные версии авантюрным
                пользователям. Пробные версии назывались XFree86-Aqua или
                сокращенно XAqua. Поскольку Торри возглавлял работу, изменения отражались
                непосредственно в хранилище CVS XFree86, что привело к
                выпуску версии 4.1.0.</p>
            <p> Сначала сопряжение с Quartz осуществлялось через
                небольшое приложение Xmaster.app (написанное в Carbon и затем
                переписанное в Cocoa). Впоследствии этот код был встроен в сам сервер X
                и породил приложение XDarwin.app. В этот же период была добавлена
                поддержка общей библиотеки (и Tenon была убеждена в использовании
                этого комплекта патчей вместо собственных патчей для обеспечения бинарной
                совместимости). Был достигнут явный прогресс в бескорневом режиме
                (с использованием Carbon API), но увы - было слишком поздно для его включения в
                XFree86 4.1.0. Бескорневой патч оказался на свободе и продолжил свое
                плавание по сети. После XFree86 4.1.0, выпущенной с полноэкранным режимом,
                работа надо бескорневым режимом продолжилась, теперь уже
                с использованием Cocoa API. Экспериментальный бескорневой режим был внесен в хранилище
                CVS XFree86.</p>
            <p>Тем временем Apple выпустила Mac OS X 10.0 и Darwin 1.3,
                а несколько недель спустя Tenon выпустила Xtools 1.0.</p>
            <p>Был продолжена работа по интеграции бескорневого режима  в
                XFree86, и таким образом ко времени выпуска XFree86 4.2.0 в январе
                2002 г. версия Darwin/Mac OS X была полностью интегрирована в
                основную дистрибуцию XFree86.</p>
        </section>
    </chapter>
    <chapter filename="inst-xfree86">
        <title>Получение и инсталляция XFree86</title>
        <shorttitle>Инсталляция XFree86</shorttitle>
        <section name="fink">
            <title>Инсталляция через Fink</title>
            <p> Fink позволит вам инсталлировать X11 любым желательным для вас образом, в то же время предоставив
                собственные пакеты XFree86. С помощью команды <code>fink
                    install ...</code> Fink скачает исходный код и скомпилирует
                его на вашем компьютере. Если вы используете <code>apt-get install
                ...</code> или <code>dselect</code>, скачаются предварительно
                скомпилированные бинарные пакеты, аналогичные официальной дистрибуции XFree86.</p>
            <p> Пакет <code>xfree86-base</code> содержит всю XFree86
                4.2.1.1 (4.2.0 для пользователей 10.1), кроме сервера XDarwin. Пакет
                <code>xfree86-rootless</code> является сервером стандартной стабильной
                версии XFree86 4.2.1.1. Он поддерживает как полноэкранную, так и
                бескорневую работу, а также имеет поддержку OpenGL. (Когда-то в самом
                начале у Fink также был пакет <code>xfree86-server</code>,
                обеспечивавший полноэкранный режим, но этой опции больше
                нет.) У вас также есть возможность инсталлировать
                сервер самостоятельно - см. ниже. Только в этом случае надо
                инсталлировать <code>xfree86-base</code>, иначе появится риск, что Fink
                сделает перезапись вашего вручную инсталлированного сервера. Имейте в виду, что текущая
                стабильная версия <code> xfree86-base</code> (4.2.1.1-3)
                генерирует <code>xfree86-rootless</code>,
                <code>xfree86-base-shlibs</code> и
                <code>xfree86-rootless-shlibs</code> в процессе построения.
                При этом вам надо иметь все четыре инсталлированных пакета, чтобы
                настройки XFree86 работали.</p>
            <p>Связные пакеты <code> xfree86-base-threaded</code> и
                <code>xfree86-rootless-threaded</code> по сути являются тем же самым,
                но модифицированы для поддержки связности, требуемой
                несколькими приложениями - такими, как <filename>xine</filename>.</p>
            <p>XFree86 4.2.11 (несвязная) считается стабильной базовой
                версией XFree86 для использования с Fink в 10.2. Также имеется XFree86 4.3.0,
                но она считается более экспериментальной; на данный момент 
                только она представлена на нестабильном дереве .
                Она имеет интегрированную связную поддержку и работает быстрее, чем 4.2.1.1.
                Для инсталляции этой версии надо инсталлировать пакет
                <code>xfree86</code>. Имейте в виду, что для этой версии
                больше нет отдельных базовых и бескорневых пакетов, хотя
                библиотеки и распределены в <code>xfree86-shlibs</code>. Если
                вы строите бинарные пакеты на основе 4.3, предупреждаем, что они могут
                не работать в 4.2.1.1 или X11 Apple.</p>
            <p>
                <em>Для пользователей 10.3:</em> Вам надо инсталлировать
                4.3.99.16-2 или более позднюю версию, которые являются предварительными выпусками XFree86-4.4.
                Если вы работаете на основе бинарной дистрибуции, убедитесь, что
                описание пакетов обновлено (н-р, через <code>sudo apt-get update</code>).</p>
        </section>
        <section name="apple-binary">
            <title>Бинарные файлы Apple</title>
            <p> 7 января 2003 г. Apple выпустила <link
                    url="http://www.apple.com/macosx/x11/">специальную реализацию X11
                    на основе XFree86-4.2</link>, включающую визуализацию
                Quartz и ускоренную OpenGL. Следующая новая версия вышла
                10 февраля 2003 г. с дополнительными характеристиками и
                корректировками. Третья версия (Beta 3) вышла 17 марта
                2003 г. с дальнейшими дополнительными характеристиками и корректировками. Эта версия
                может использоваться в Jaguar.</p>
            <p>24 октября 2003 г. Apple выпустила Panther (10.3), включающую
                версию ее дистрибуции X11. Эта версия
                основана на XFree86-4.3.</p>
            <p> Перед использованием бинарных файлов Apple надо удостовериться, что инсталлирован пакет <em>X11
                User</em>, а также <link
                url="/doc/users-guide/upgrade.php">обновить</link> Fink.</p>
            <p>Для версии <code>fink-0.16.2</code> вам надо будет также инсталлировать пакет
                    <em>X11 SDK</em>. После этого Fink
                создаст виртуальный пакет <code>system-xfree86</code>.</p>
            <p>В случае <code>fink-0.17.0</code> и более поздних версий необходима лишь инсталляция X11 SDK,
                если вы хотите построить пакеты от исходного кода. В подобном случае,
                даже если у вас не будет SDK, будут виртуальные пакеты
                <code>system-xfree86</code> и
                <code>system-xfree86-shlibs</code>, причем последний будет представлять
                общие библиотеки. Если вы инсталлируете SDK,
                также будет пакет <code>system-xfree86-dev</code>,
                представляющий заголовки.</p>
            <p> Если у вас уже инсталлирована дистрибуция XFree86 - через
                Fink или иным образом - можно выполнить <xref
                    section="switching-x11" chapter="inst-xfree86">Инструкции
                    по замене одного пакета X11 другим пакетом</xref>. Удалите
                существующий пакет, а затем инсталлируйте X11 Apple
                (и X11 SDK, если это необходимо или желательно).</p>
            <p> Некоторые примечания по использованию X11 Apple:</p>
            <ul>
                <li>
                    <p>Пакет <filename>autocutsel</filename> больше не нужен.
                        Если вы запускаете X11, а этот пакет активирован, надо
                        его дезактивировать.</p>
                </li>
                <li>
                    <p>X11 Apple использует ваш существующий файл
                        <filename>~/.xinitrc</filename>. Если вы хотите
                        получить полноценный эффект от интеграции Quartz , надо использовать
                        <filename>/usr/X11R6/bin/quartz-wm</filename> в качестве
                        менеджера окон или полностью удалить
                        <filename>~/.xinitrc</filename>.</p>
                    <p>Если вам нужна только интеграция копирования в буфер и вставки из него, но при этом вы хотите
                        использовать другой менеджер окон, можно сделать как в
                        следующем примере:</p>
                    <codeblock>/usr/X11R6/bin/quartz-wm --only-proxy &amp;
                        exec /opt/sw/bin/fvwm2</codeblock>
                    <p>Разумеется, можно сделать вызов другого менеджера окон, н-р,
                        <code>startkde</code> и т.д.</p>
                </li>
                <li>
                    <p>
                        <filename>quartz-wm</filename> не полностью поддерживает опции менеджера окон
                        Gnome/KDE, поэтому вы можете столкнуться с его
                        странным поведением в окнах, которые имеют декоративные обрамления, тогда как
                        не должны их иметь.</p>
                </li>
                <li>
                    <p>X11 Apple не признает настройки среды Fink по
                        умолчанию. Для вызова приложений запуска, инсталлированных
                        при помощи fink (н-р, менеджеров окон,
                        gnome-session и других в
                        <filename>/opt/sw/bin</filename>), внесите следующее
                        в верхней части <filename>~/.xinitrc</filename> (т.е.
                        после
                        &quot;<filename>#!/bin/sh</filename>&quot;, но
                        перед запуском любой программы):</p>
                    <codeblock> . /opt/sw/bin/init.sh</codeblock>
                    <p>чтобы запустить среду Fink. Примечание: лучше использовать
                        <filename>init.sh</filename>, чем
                        <filename>init.csh</filename>, поскольку
                        <filename>.xinitrc</filename> лучше выполняется посредством
                        <filename>sh</filename>, чем <filename>tcsh</filename>.</p>
                </li>
                <li>
                    <p>Приложения, требующие для выполнения некоторых своих функций вызова других программ,
                        находящихся в пределах вашего дерева Fink,
                        требуют особого обращения при их вовлечении в работу путем вызова
                        из меню приложений. Вместо добавления одного только
                        полного маршрута к имени файла, н-р:</p>
                    <codeblock>/opt/sw/bin/emacs</codeblock>
                    <p>лучше использовать что-то вроде следующего, если
                        вы используете bash в качестве оболочки по умолчанию:</p>
                    <codeblock>. /opt/sw/bin/init.sh ; emacs</codeblock>
                    <p>или, если вы используете tcsh:</p>
                    <codeblock>source /opt/sw/bin/init.csh ; emacs</codeblock>
                    <p>Это обеспечивает правильный PATH
                        приложения. Можно использовать этот синтаксис для любого
                        приложения, инсталлированного при помощи Fink.</p>
                </li>
                <li>
                    <p>Если вы пытаетесь построить пакет вручную на основе
                        X11 Apple и получаете следующее сообщение об ошибке:</p>
                    <codeblock>ld: err.o illegal reference to symbol:
                        _XSetIOErrorHandler defined in indirectly referenced
                        dynamic library /usr/X11R6/lib/libX11.6.dylib</codeblock>
                    <p>надо проверить наличие <code>-lX11</code>
                        в процессе связывания. Просмотрите опции конфигурации своего
                        пакета, чтобы увидеть, как обеспечить этот дополнительный параметр.</p>
                </li>
                <li>
                    <p>Если вы используете пакет <code>xfree86</code> и затем
                        переходите на X11 Apple (10.2.x или 10.3.x), из-за несовместимости бинарных файлов надо заново построить все пакеты,
                        созданные до этого с помощью <code>xfree86</code>.
                        </p>
                </li>
            </ul>
        </section>
        <section name="official-binary">
            <title>Официальные бинарные файлы</title>
            <p> В проекте XFree86 есть официальная бинарная дистрибуция
                XFree86 4.2.0, которую можно обновить до 4.2.1.1 с патчами.
                Ее можно найти на локальном зеркале <link
                    url="http://www.xfree86.org/MIRRORS.shtml">XFree86
                mirror</link> в каталоге
                <code>4.2.0/binaries/Darwin-ppc-5.x</code>. Убедитесь в получении тарболов
                <filename>Xprog.tgz</filename> и
                <filename>Xquartz.tgz</filename>, даже если они отмечены как
                необязательные. Если вы не уверены в том, что именно вам нужно, просто скачайте
                весь каталог. Выполните скрипт
                <filename>Xinstall.sh</filename> в качестве суперпользователя для
                инсталляции всего материала. (Рекомендуем прочитать <link
                    url="http://www.xfree86.org/4.2.0/Install.html">Официальные инструкции
                </link> перед инсталляцией.) Если хотите, можете
                использовать <link
                url=" http://prdownloads.sourceforge.net/xonx/XInstall_10.1.sit?download">binary</link>
                из XonX, использующий идентичный, но более легкий в применении исходный код. Тем или иным образом
                скачайте, разархивируйте и сделайте следующие обновления:</p>
            <ol>
                <li>для 10.1: <link
                        url="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.0.1-10.1.zip?download">4.2.0
                        -&gt; 4.2.0.1 upgrade</link>. для 10.2: <link
                        url="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.0.1-10.2.zip?download">4.2.0
                        -&gt; 4.2.0.1 upgrade</link>
                </li>
                <li>для 10.1 и 10.2: <link
                        url="http://prdownloads.sourceforge.net/xonx/XFree86_4.2.1.1.zip?download">4.2.0.1
                        -&gt; 4.2.1.1 upgrade</link>
                </li>
            </ol>
            <p>Также существует официальная дистрибуция XFree86 4.3.0 на
                <link
                    url="http://www.xfree86.org/MIRRORS.shtml">XFree86
                    mirrors</link> в каталоге
                <code>4.3.0/binaries/Darwin-ppc-6.x</code>. Убедитесь в получении тарболов
                <filename>Xprog.tgz</filename> и
                <filename>Xquartz.tgz</filename>, даже если они отмечены как
                необязательные. Если вы не уверены в том, что именно вам нужно, просто скачайте
                весь каталог. Выполните скрипт
                <filename>Xinstall.sh</filename> в качестве суперпользователя для
                инсталляции всего материала. (Рекомендуем прочитать <link
                    url="http://www.xfree86.org/4.3.0/Install.html">Официальные инструкции
                </link> перед инсталляцией.) </p>
            <p>Независимо от установленной версии, теперь вы имеете XFree86 с
                сервером для полноэкранного либо бескорневого режима работы в Mac OS X.</p>
        </section>
        <section name="official-source">
            <title>Официальный исходный код</title>
            <p> Если у вас есть свободное время, можно построить XFree86 4.2.0
               от исходного кода. Исходный код можно найти на локальном зеркале <link
                    url="http://www.xfree86.org/MIRRORS.shtml">XFree86
                mirror</link> в каталоге <code>4.2.0/source</code>. Скачайте все три тарбола
                 <filename>X420src-#.tgz</filename> и извлеките их
                в одном каталоге. Можно установить собственные настройки для построения,
                внеся макроопределения в
                файл <filename>config/cf/host.def</filename> на дереве исходного кода XFree86.
                

                <!--
To build on pure Darwin, create the file
<code>config/cf/host.def</code> in the XFree86 source tree and put the
following line in it:
</p>
<codeblock>#define DarwinQuartzSupport NO</codeblock>
<p>
You can add further defines to that file if you want; see
-->
                См. <filename>config/cf/darwin.cf</filename> для получения подсказок.
                (Прим.: Только макросы с пометкой #ifndef
                могут быть перезаписаны в host.def.)</p>
            <p> Когда конфигурация будет вас удовлетворять, скомпилируйте и инсталлируйте
                XFree86 посредством следующих команд:</p>
            <codeblock>make World sudo make install install.man</codeblock>
            <p>Для обновления до 4.2.1.1 надо следовать инструкциям раздела <xref
                    section="official-binary">Официальные бинарные файлы</xref>.</p>
            <p>Для инсталляции 4.3.0 надо следовать вышеуказанным инструкциям, заменив
                &quot;2&quot; на &quot;3&quot;, но не надо выполнять
                процедуру обновления 4.2.1.1.</p>
            <p> Как и в случае с официальными бинарными файлами, теперь у вас есть XFree86 с
                сервером, который может обеспечивать полноэкранный или бескорневой режим в Mac OS X.</p>
        </section>
        <section name="latest-cvs">
            <title>Исходный код на основе последних разработок</title>
            <p> Если вы располагаете не только временем, но и запасом нервных клеток, можно
                получить последнюю разработку версии XFree86 из общего хранилища
                CVS. Предупреждаем, что код находится в процессе постоянного
                развития; сегодняшний код обычно отличается от вчерашнего.
                </p>
            <p> Для выполнения инсталляции следуйте инструкциям относительно <link
                url="http://www.xfree86.org/cvs/">CVS XFree86</link>
                для скачивания модуля <filename>xc</filename>.
                Затем надо выполнить инструкции по построению, указанные выше.</p>
        </section>
        <!--><section name="xonx-bin" >
<title>The XonX binary test releases (XAqua,
XDarwin)</title>
<p>
In the time before 4.1.0 was released, the XonX team put out a series
of binary test releases with the name XAqua.
These releases are obsolete and should not be used.
</p>
<p>
With the introduction of rootless mode into XFree86's mainline CVS
(after 4.1.0 was released), the XonX team once again started to
put out binary test releases, this time under the name XDarwin.
This eventually resulted in the XDarwin released with 4.2.0.
</p>
<p>The <link url="http://www.mrcla.com/XonX/" >XonX
web page</link> indicates that post-4.2.0 testing versions of XDarwin may
someday be released, but none have been as yet.  They would presumably be 
installed on top of XFree86 4.2.0 (or later).
</p>
</section><-->
        <section name="macgimp">
            <title>MacGimp</title>
            <p> Скачиваемый инсталлятор, предложенный разработчиками MacGimp
                в 2001 г., не содержал XFree86. (Впрочем, он сделал бы
                перезапись некоторых файлов конфигурации XFree86.)</p>
            <p> Компакт-диск, продаваемый <link url="http://www.macgimp.com/">MacGimp,
                Inc.</link>, якобы содержит XFree86. Не совсем понятно,
                какая это версия; это может быть смесь 4.0.3,
                4.1.0 и собственной разработки. Сервер обеспечивает работу в бескорневом режиме
                с использованием патча, созданного до 4.1.0.</p>
        </section>
        <!--><section name="rootless" >
<title>Roaming Rootless Servers</title>
<p>
There are various rootless server binaries roaming around
the net.  With the release of the official 4.2.0 binaries
this should not be a desirable way to install XFree86.
</p>
</section><-->
        <section name="switching-x11">
            <title>Замена X11</title>
            <p> Если у вас инсталлирован один из пакетов Fink X11, но по какой-либо причине
                надо его удалить и заменить другим,
                выполняется прямолинейная процедура.
                Надо принудительно удалить старый пакет и затем инсталлировать
                новый, чтобы поддержать последовательность базы данных dpkg.</p>
            <p> Выполнить это можно двумя способами:</p>
            <ol>
                <li>
                    <p>Использовать FinkCommander</p>
                    <p> Если вы используете <link
                        url="http://finkcommander.sourceforge.net/">FinkCommander</link>,
                        можно сделать принудительное удаление ("force remove") через меню. Например, если
                        у вас инсталлирован <filename>xfree86-rootless</filename>,
                        а вы хотите установить связную версию, надо выделить пакеты
                        <filename>xfree86-rootless</filename>,
                        <filename>xfree86-rootless-shlibs</filename>,
                        <filename>xfree86-base</filename> и
                        <filename>xfree86-base-shlibs</filename> и применить
                         </p>
                    <codeblock>Source -&gt; Force Remove</codeblock>
                </li>
                <li>
                    <p>Удалить вручную со строки команд</p>
                    <p> Надо применить
                        <filename>dpkg</filename> с опцией --force-depends,
                        н-р: </p>
                    <codeblock>sudo dpkg -r --force-depends xfree86-rootless\
                        xfree86-rootless-shlibs xfree86-base xfree86-base-shlibs</codeblock>
                    <p> Имейте в виду, что если у вас есть приложения, требующие связной версии пакета
                        XFree86, могут возникнуть проблемы с базой данных dpkg, если вы
                        принудительно удаляете его и инсталлируете другой пакет XFree86
                        или заполнителя. </p>
                </li>
            </ol>
            <p>Версию X11, инсталлированную не через
                Fink, удаляют со строки команд:</p>
            <codeblock>sudo rm -rf /usr/X11R6 /etc/X11</codeblock>
            <p>Вышеуказанное относится к удалению любого параметра X11, инсталлированного не
                через Fink. Вам надо будет также удалить
                <filename>XDarwin.app</filename> |<code>X11.app</code>,
                в зависимости от того, что инсталлировано. При удалении X11 Apple проверьте свой файл
                <filename>.xinitrc</filename>, чтобы убедиться, что
                вы не пытаетесь использовать
                <filename>quartz-wm</filename>. Затем можно инсталлировать любую нужную вам
                X11, вручную или через Fink.</p>
        </section>
        <section name="fink-summary">
            <title>Обзор пакетов Fink</title>
            <p> Краткий обзор видов инсталляции и пакетов Fink, которые вам надо инсталлировать: 
                </p>
            <itemtable labelt="Вид инсталляции" labeld="Пакеты Fink">
                <item>
                    <itemt>4.2.x  при помощи Fink</itemt>
                    <itemd>
                        <p>
                            <code>xfree86-base</code> и
                            <code>xfree86-rootless</code> (и их <code>-shlibs</code>)</p>
                        <p>или <code>xfree86-base-threaded</code> и
                            <code>xfree86-rootless-threaded</code> (и <code>-shlibs</code>)</p>
                    </itemd>
                </item>
                <item>
                    <itemt>4.3.x при помощи Fink</itemt>
                    <itemd>
                        <p>
                            <code>xfree86</code> и <code>xfree86-shlibs</code>
                        </p>
                    </itemd>
                </item>
                <item>
                    <itemt>4.x на основе официальных бинарных файлов  </itemt>
                    <itemd>
                        <p>
                            только <code>system-xfree86</code> (+разделители)</p>
                    </itemd>
                </item>
                <item>
                    <itemt>4.x на основе исходного кода или последнего исходного кода CVS</itemt>
                    <itemd>
                        <p>
                            только <code>system-xfree86</code> (+разделители)</p>
                    </itemd>
                </item>
                <!--obsolete><item>
<itemt>4.2.x base system built via Fink + binary rootless server</itemt>
<itemd>
<p>
<code>xfree86-base</code> only</p>
</itemd>
</item><-->
                <item>
                    <itemt>4.2.x от Apple</itemt>
                    <itemd>
                        <p>
                            только <code>system-xfree86</code> (+разделители)</p>
                    </itemd>
                </item>
                <item>
                    <itemt>4.3.x от Apple</itemt>
                    <itemd>
                        <p>
                            только <code>system-xfree86</code> (+разделители)</p>
                    </itemd>
                </item>
            </itemtable>
        </section>
    </chapter>
    <chapter filename="run-xfree86">
        <title>Запуск XFree86</title>
        <shorttitle>Запуск XFree86</shorttitle>
        <section name="darwin">
            <title>Darwin</title>
            <p> В чистой Darwin XFree86 ведет себя также, как в других продуктах Unix.
                Обычный способ запуска - через <code>startx</code> с консоли;
                запускается сервер и некоторые исходные клиенты, такие,
                как менеджер окон и терминальный эмулятор с оболочкой.  В чистой
                Darwin не требуется уточнять параметры, достаточно
                просто напечатать:</p>
            <codeblock>startx</codeblock>
            <p> Можно сделать настройки запуска в нескольких файлах
                в своем базовом каталоге. <filename>.xinitrc</filename> управляет очередностью
                запуска клиентов. <filename>.xserverrc</filename> управляет
                опциями сервера и даже может запускать другой сервер. В случае возникновения проблем
                (н-р, появится пустой экран или XFree86
                переместит вас обратно к консоли) их можно исправить
                путем удаления этих файлов. Если не удается найти эти файлы при помощи
                <code>startx</code>, в действие вступают безотказные настройки по
                умолчанию.</p>
            <p> В качестве альтернативы можно запустить сервер напрямую при помощи
                одной из опций XDMCP, н-р:</p>
            <codeblock>X -query remotehost</codeblock>
            <p> Подробную информацию можно найти на странице руководства <code>Xserver</code>.
                </p>
            <p> Наконец, можно настроить <code>xdm</code>; см.
                страницу руководства.</p>
            <p> Прим.: Если вы используете Mac OS X, предшествующую Panther, можно напечатать
                <code>&gt;console</code> в окне регистрации и получить
                текстовую консоль, эквивалентную чистой Darwin. Если вы не видите
                области для ввода имени пользователя в окне регистрации,
                просто напечатайте начальную букву любого имени пользователя и затем нажмите
                alt-return. Можно использовать все методы запуска,
                описанные выше, кроме <code>xdm</code>.</p>
            <p> Прим.: При использовании Mac OS X Panther вы не сможете запускать
                XFree86 из окна консоли.</p>
        </section>
        <section name="macosx-41">
            <title>Mac OS X + XFree86 4.x.y</title>
            <p> Есть два основных способа запустить XFree86 в Mac OS X.
                Первый: двойным щелчком на приложении XDarwin.app в каталоге
                приложений. Это позволит сделать выбор между полноэкранным и бескорневым режимом
                в диалоге при запуске. Можно дезактивировать диалог
                и настроить XDarwin на постоянное использование выбранного вами режима
                в диалоге параметров.</p>
            <p> До выпуска 4.2.0 это действие автоматически активировало полноэкранный режим
                и не было способа активации бескорневого режима двойным щелчком.</p>
            <p> Другой способ запуска XFree86 в Mac OS X:
                при помощи <code>startx</code> из Terminal.app. При запуске сервера таким образом
                надо указать, что он должен работать параллельно
                Quartz. Это можно сделать при помощи опции <code>-fullscreen</code>,
                н-р:</p>
            <codeblock>startx -- -fullscreen</codeblock>
            <p> Таким образом происходит запуск сервера в полноэкранном режиме, а также
                клиентов в <filename>.xinitrc</filename>.</p>
            <p> ПРИМЕЧАНИЕ: до выпуска 4.2 для активации полноэкранного режима применяли <code>-quartz</code>.</p>
            <p> Если ваш сервер поддерживает бескорневые операции, можно
                запустить его в бескорневом режиме при помощи опции <code>-rootless</code>:</p>
            <codeblock>startx -- -rootless</codeblock>
            <p> Опция <code>-quartz</code> больше не активирует полноэкранный режим, а
                использует режим по умолчанию, определенный в параметрах.</p>
            <p>Что касается 4.3, если вы используете <code>startx</code> без настройки параметров, появляется
                окно диалога запуска.</p>
        </section>
        <section name="xinitrc">
            <title>Файл .xinitrc</title>
            <p> Если в вашем базовом каталоге имеется файл с именем <filename>.xinitrc</filename>,
                он будет использоваться для запуска некоторых исходных клиентов X,
                н-р, менеджера окон, некоторых xterms или среды рабочего стола типа
                GNOME. Файл <filename>.xinitrc</filename> является скриптом оболочки,
                содержащим команды для выполнения указанного. <em>Не</em>
                надо указывать <code>#!/bin/sh</code> в первой строке
                и настраивать выполняемый бит в имени файла; xinit знает, как
                запустить его через оболочку.</p>
            <p> Если в вашем базовом каталоге нет файла <filename>.xinitrc</filename>,
                XFree86 использует по умолчанию свой файл
                <filename>/private/etc/X11/xinit/xinitrc</filename>. Можно использовать
                файл по умолчанию в качестве отправной точки для собственного .xinitrc:</p>
            <codeblock>cp /private/etc/X11/xinit/xinitrc ~/.xinitrc</codeblock>
            <p> Если вы используете Fink, надо поместить
                <filename>init.sh</filename> в самом начале для
                обеспечения правильности настроек среды.</p>
            <p> Вы можете внести произвольные команды в
                <filename>.xinitrc</filename>, но здесь надо кое-что пояснить.
                Во-первых, интерпретирующая файл оболочка по умолчанию будет ждать
                завершения работы каждой отдельной программы, прежде чем запустить следующую. Если
                вы хотите, чтобы несколько программ работали параллельно, надо приказать оболочке
                поместить их &quot;на задний план&quot;, добавив
                <code>&amp;</code> в конце строки.</p>
            <p> Во-вторых, <code>xinit</code> ждет, пока скрипт
                <filename>.xinitrc</filename> закончит работу и интерпретирует окончание работы
                таким образом: &quot;сеанс завершен, теперь я также должен уничтожить сервер X
                &quot;. Это значит, что последняя команда вашего файла
                 <filename>.xinitrc</filename> не должна выполняться на
                заднем плане, а должна быть программой длительного действия. Обычно
                для этой цели используется менеджер окон. Вообще,
                менеджеры окон предполагают, что <code>xinit</code> ждет окончания их
                работы и используют это для ввода записи о &quot;завершении
                сеанса&quot; в работу их меню. (Прим.: Для сохранения
                циклов ОЗУ и центрального процессора можно указать <code>exec</code> перед
                последней строкой, как в примере ниже.)</p>
            <p> Простой пример запуска GNOME:</p>
            <codeblock>. /opt/sw/bin/init.sh exec gnome-session</codeblock>
            <p>Более сложный пример для пользователей bash, который отключает X11,
                делает запуск некоторых клиентов и в конце концов менеджера окон Enlightenment:
                </p>
            <codeblock>. /opt/sw/bin/init.sh xset b off xclock -geometry -0+0
                &amp; xterm &amp; xterm &amp; exec enlightenment</codeblock>
            <p>Для запуска GNOME 2.2 в X11 Apple используйте следующую последовательность:</p>
            <codeblock>. /opt/sw/bin/init.sh quartz-wm --only-proxy &amp;
                metacity &amp; exec gnome-session</codeblock>
            <p>При запуске GNOME 2.4 в X11 Apple metacity запускается автоматически,
                и таким образом последовательность следующая:</p>
            <codeblock>. /opt/sw/bin/init.sh quartz-wm --only-proxy &amp; exec gnome-session</codeblock>
            <p>Для запуска KDE 3.2 (версия &lt; 3.2.2-21) в X11 Apple используйте</p>
            <codeblock>. /opt/sw/bin/init.sh export KDEWM=kwin quartz-wm
                --only-proxy &amp; /opt/sw/bin/startkde &gt;/tmp/kde.log 2&gt;&amp;1</codeblock>
            <p>Наконец, для запуска последней нестабильной версии KDE в
                X11 Apple:</p>
            <codeblock>. /opt/sw/bin/init.sh /opt/sw/bin/startkde &gt;/tmp/kde.log 2&gt;&amp;1</codeblock>
        </section>
    </chapter>
    <chapter filename="xtools">
        <title>Xtools</title>
        <shorttitle>Xtools</shorttitle>
        <section name="install">
            <title>Инсталляция Xtools</title>
            <p> Теперь это легко изменить. Получите инсталлятор, дважды щелкните на нем и
                следуйте инструкциям. Внимательно выберите объем запуска, когда
                об этом появится запрос.</p>
            <p> При использовании Fink надо инсталлировать
                пакет <code>system-xtools</code> после инсталляции
                Xtools. Этот пакет не инсталлирует никакие файлы, а просто
                проверяет наличие библиотек и т.п., а также действует в качестве заполнителя в
                системе зависимостей Fink.</p>
        </section>
        <section name="run">
            <title>Запуск Xtools</title>
            <p> Для запуска Xtools надо дважды щелкнуть на Xtools.app в каталоге
                приложений. Как и XFree86, Xtools производит запуск клиентов, указанных вами в
                файле <filename>.xinitrc</filename>. Помимо этого, Xtools
                позволяет делать запуск клиентов через меню.</p>
        </section>
        <section name="opengl">
            <title>Примечания в связи с OpenGL</title>
            <p> Xtools применяет аппаратное ускорение OpenGL в бескорневом режиме и
                имеет библиотеки для его поддержки. Основная библиотека libGL
                очень хорошая, тогда как библиотеки libGLU и libglut представлены только в
                статическом виде, чего недостаточно для полной бинарной совместимости
                с XFree86. Кроме того, не хватает некоторых заголовков.
                На данный момент Fink не может предложить решения этой проблемы. Будем надеяться, что
                она будет решена в Xtools 1.1.</p>
        </section>
    </chapter>
    <chapter filename="other">
        <title>Другие возможности X11</title>
        <shorttitle>Другие возможности</shorttitle>
        <section name="vnc">
            <title>VNC</title>
            <p> VNC - система графики с сетевой архитектурой, аналогичной
                X11 по дизайну. При этом она работает на более низком уровне, что
                облегчает ее реализацию. С сервером Xvnc и клиентом отображения Mac OS X
                можно использовать приложения X11 в Mac
                OS X. Страница Джеффа Уайтейкера <link
                    url="http://www.cdc.noaa.gov/~jsw/macosx_xvnc/">Xvnc
                </link> рассказывает об этом более подробно.</p>
        </section>
        <section name="wiredx">
            <title>WiredX</title>
            <p>
                <link url="http://www.jcraft.com/wiredx/">WiredX</link> - сервер
                X11, написанный на языке Java. Он также поддерживает бескорневой режим. Его веб-сайт предоставляет пакет
                Installer.app.</p>
        </section>
        <section name="exodus">
            <title>eXodus</title>
            <p> Согласно своему веб-сайту, <link
                    url="http://www.powerlan-usa.com/exodus/">eXodus 8</link> от
                Powerlan USA работает в Mac OS X. Неизвестно, какую
                кодовую базу он использует, предоставляет ли поддержку локальным клиентам и если да, то каким образом.
                По этой причине Fink не обеспечивает специальную поддержку, предназначенную для eXodus.
                Если у вас есть более подробная информация, просим сообщить нам.</p>
        </section>
    </chapter>
    <chapter filename="trouble">
        <title>Устранение проблем, возникших в связи с XFree86</title>
        <shorttitle>Устранение проблем</shorttitle>
        <section name="immedate-quit">
            <title>При запуске XDarwin она практически сразу завершает работу или зависает</title>
            <p> Прежде всего: не паникуйте! Есть масса вещей, которые плохо работают с
                XFree86, и многие из них могут вызывать сбои при
                запуске. Кроме того, нет ничего необычного в том, что XDarwin прекращает работу,
                когда сталкивается в проблемами запуска. В данном разделе мы попытаемся отразить все
                проблемы, с которыми вы можете столкнуться. Но прежде всего
                вам надо собрать всю необходимую информацию:</p>
            <p>
                <em>Версия XDarwin.</em> Вы можете найти версию XDarwin в искателе
                (Finder), щелкнув <em>один раз</em> на иконке XDarwin и выделив
                &quot;Show Info&quot; в меню. Версия отражает возрастающие номера
                новых пробных бинарных версий в рамках проекта
                XonX, и таким образом &quot;1.0a1&quot; фактически может быть
                любой версией между 1.0a1 и 1.0a2.</p>
            <p>
                <em>Сообщения об ошибках.</em> Далее даны основные виды точного описания
                отдельных возникающих проблем. От вашего способа запуска XDarwin зависит
                форма получения сообщения об ошибке. Если вы запускаете
                <code>startx</code> из терминального окна, сообщение появится непосредственно в этом
                окне. Не забывайте, что можно использовать прокрутку.
                Если вы запускаете XDarwin при помощи двойного щелчка на иконке,
                сообщение поступит в системный журнал, к которому вы можете получить доступ
                через приложение консоли в каталоге утилит. Убедитесь, что
                выбираете правильный (т.е. последний) набор сообщений.</p>
            <p> Начнем со списка сообщений, которые вы можете увидеть:</p>
            <codeblock>_XSERVTransmkdir: Owner of /tmp/.X11-unix should be set
                to root</codeblock>
            <codeblock>_IceTransmkdir: Owner of /tmp/.ICE-unix should be set to root</codeblock>
            <p> Классификация ошибки: безобидная. X11 создает скрытые каталоги в /tmp для хранения
                &quot;файлов&quot; разъемов для локальных соединений. Из соображений
                безопасности X11 предпочитает, чтобы эти каталоги принадлежали
                суперпользователю, но поскольку они в любом случае пишутся пословно, в их работе
                не возникает проблем. (Прим.: Их владение суперпользователем крайне затруднительно,
                т.к. Mac OS X удаляет /tmp при перезагрузке, а работе XDarwin
                не присущи привилегии суперпользователя, впрочем они ей и не требуются.)</p>
            <codeblock>QuartzAudioInit: AddIOProc returned 1852797029</codeblock>
            <codeblock>-[NSCFArray objectAtIndex:]: index (2) beyond bounds (2)</codeblock>
            <codeblock>kCGErrorIllegalArgument : CGSGetDisplayBounds (display 35434400)</codeblock>
            <codeblock>No core keyboard</codeblock>
            <p> Классификация ошибки: сомнительная. Это проистекающие ошибки в результате
                попытки сервера вновь настроить самого себя после предыдущей ошибки. В процессе этого
                печатается другая копия баннера запуска, после чего появляется одно или несколько из вышеуказанных сообщений,
                поскольку повторная настройка сервера не может работать должным образом
                в поврежденных версиях XDarwin. Если вы получаете подобные сообщения, надо
                сделать прокрутку в терминальном окне соответствующей консоли
                и поискать другой набор баннера и сообщений. 
                Это относится ко всем версиям вплоть до XDarwin 1.0a3 включительно; данная проблема
                была решена после выпуска 1.0a3.</p>
            <codeblock>cat: /Users/chrisp/.Xauthority: No such file or directory</codeblock>
            <p> Классификация ошибки: практически безобидная. Неизвестно, как эти сообщения приходят,
                но на работу они не влияют. Можно от них избавиться, применив
                 <code>touch .Xauthority</code> в базовом
                каталоге.</p>
            <codeblock>Gdk-WARNING **: locale not supported by C library</codeblock>
            <p> Классификация ошибки: безобидная. Она просто отражает свое содержание и не
                препятствует работе приложения. Более подробно <xref
                    section="locale">см. ниже</xref>.</p>
            <codeblock>Gdk-WARNING **: locale not supported by Xlib, locale set
                to C Gdk-WARNING **: can not set locale modifiers</codeblock>
            <p> Классификация ошибки: серьезная, но не фатальная. Такие сообщения могут появляться в дополнение к
                вышеуказанным. Они означают, что локальные файлы данных XFree86
                отсутствуют. Нам представляется, что они появляются
                невоспроизводимым образом при построении Free86 от исходного кода. Большинство приложений
                будут продолжать работу, за очевидным исключением GNU Emacs.</p>
            <codeblock>Unable to open keymapping file USA.keymapping. Reverting
                to kernel keymapping.</codeblock>
            <p> Классификация ошибки: чаще всего фатальная. Это может произойти с XDarwin 1.0a1 при активации
                опции раскладки клавиатуры &quot;Загрузить из файла&quot; (&quot;Load from file&quot;).
                Данная версия нуждается в полном маршруте при настройке загрузки файла через
                диалог параметров, но производит автоматический поиск при ее передаче на
                строку команд. Это сообщение обычно сопровождается
                другим сообщением с &quot;assert&quot;, приведенным ниже. Для исправления
                ошибки выполните нижеуказанные инструкции.</p>
            <codeblock>Fatal server error: assert failed on line 454 of darwinKeyboard.c!</codeblock>
            <codeblock>Fatal server error: Could not get kernel keymapping! Load
                keymapping from file instead.</codeblock>
            <p> Классификация ошибки: фатальная. Изменения, внесенные Apple в Mac OS X 10.1, повредили код
                XFree86, считывающий раскладку клавиатуры из
                ядра операционной системы; в результате появилось данное сообщение.
                Надо использовать опцию &quot;Загрузить из файла&quot; (&quot;Load from file&quot;) в
                Mac OS X 10.1. Настройка находится в диалоге параметров XDarwin.
                Убедитесь, что файл выделен (т.е. используйте кнопку &quot;Pick
                file&quot;) - простая активация отмечаемой кнопки недостаточна в
                некоторых версиях XDarwin. Если вы не можете попасть в диалог параметров
                из-за того, что XDarwin закрывается прежде, чем у вас появляется возможность это сделать,
                используйте <code>startx --
                    -quartz -keymap USA.keymapping</code> в терминальном окне. Обычно этого достаточно для запуска
                XDarwin; затем вы можете отразить постоянный выбор в
                диалоге параметров.</p>
            <codeblock>Fatal server error: Could not find keymapping file .</codeblock>
            <p>Классификация ошибки: фатальная (о чем и сообщается). Данная ошибка возникает по причине отсутствия
                файлов раскладки клавиатуры в Panther. Надо инсталлировать
                <code>xfree86-4.3.99-16</code> или более позднюю версию - они не нуждаются в
                файлах раскладки клавиатуры.</p>
            <codeblock>Warning: no access to tty (Inappropriate ioctl for
                device). Thus no job control in this shell.</codeblock>
            <p> Классификация ошибки: в большинстве случаев безобидная. XDarwin 1.0a2 и более поздние версии запускают
                интерактивную оболочку на заднем плане для запуска клиентского файла
                (.xinitrc). Это делается для того, чтобы вам не пришлось добавлять
                определения для настройки PATH в этом файле. Некоторые оболочки жалуются, что
                они не подсоединены к реальному терминалу, но на это можно не обращать внимания,
                потому что оболочки не используются в целях
                управления заданиями и т.п.</p>
            <codeblock>Fatal server error: failed to connect as window server!</codeblock>
            <p> Классификация ошибки: фатальная. Она означает, что сервер консольного режима (для чистой
                Darwin) начал работу, пока вы были в Aqua. Как правило, это
                происходит, если для инсталляции была использована официальная бинарная дистрибуция XFree86
                без тарбола Xquartz.tgz. Это также может произойти,
                если алиасы в /usr/X11R6/bin перепутались или вы использовали
                команду <code>XDarwin</code> в терминальном окне для
                запуска сервера (в последнем случае надо вместо нее использовать команду startx -
                см. <xref chapter="run-xfree86">Starting XFree86</xref>).</p>
            <p> В любом из этих случаев вы можете использовать <code>ls -l /usr/X11R6/bin/X*</code>
                и проверить выходные данные. Вы должны увидеть четыре соответствующих записи:
                <code>X</code>, алиас со ссылкой на
                <code>XDarwinStartup</code>;<code>XDarwin</code>, выполняемый файл
                (это сервер с консольным режимом);
                <code>XDarwinQuartz</code>, алиас со ссылкой на
                <filename>/Applications/XDarwin.app/Contents/MacOS/XDarwin</filename>;
                <code>XDarwinStartup</code>, небольшой выполняемый файл. Если какие-либо из данных записей отсутствуют
                или ссылаются на другие файлы, надо сделать исправление.
                Способ исправления зависит от способа, использованного вами при
                инсталляции XFree86. Если вы инсталлировали XFree86 при помощи Fink, надо
                вновь инсталлировать пакет <code>xfree86</code> (или
                <code>xfree86-rootless</code> для OS 10.2 и более ранних версий). Если вы инсталлировали его
                самостоятельно, надо получить файлы из копии Xquartz.tgz.</p>
            <codeblock>The XKEYBOARD keymap compiler (xkbcomp) reports: &gt;
                Error: Can't find file &quot;unknown&quot; for geometry
                include &gt; Exiting &gt; Abandoning geometry file
                &quot;(null)&quot; Errors from xkbcomp are not fatal to
                the X server</codeblock>
            <p> Классификация ошибки: в большинстве случаев безобидная. Как следует из сообщения, это не фатальная ошибка.
                Насколько мне известно, XDarwin вообще не использует расширение XKB.
                Возможно, какая-то клиентская программа пытается его тем не менее использовать ...</p>
            <codeblock>startx: Command not found.</codeblock>
            <p> Классификация ошибки: фатальная. Это может произойти с XDarwin 1.0a2 и 1.0a3, если
                ваши файлы инциализации оболочки не содержат настроек для добавления
                /usr/X11R6/bin к переменной величине PATH. Если вы используете Fink и не изменили
                настройки оболочки по умолчанию, для исправления должно быть достаточно добавления строки <code>source
                /opt/sw/bin/init.csh</code> к <filename>.cshrc</filename> в базовом каталоге
                (как рекомендуется в инструкциях Fink).
                </p>
            <codeblock>_XSERVTransSocketUNIXCreateListener:
                ...SocketCreateListener() failed
                _XSERVTransMakeAllCOTSServerListeners: server already running</codeblock>
            <codeblock>Fatal server error: Cannot establish any listening
                sockets - Make sure an X server isn't already running</codeblock>
            <p> Классификация ошибки: фатальная. Она происходит после случайного одновременного запуска нескольких
                копий XDarwin или после некорректного выключения
                 XDarwin (н-р, при зависании). Также это может быть проблема полномочий доступа к
                файлам разъемов для локальных соединений. Можно попытаться воспользоваться
                <code>rm -rf /tmp/.X11-unix</code>.
                В большинстве случаев также помогает повторный запуск компьютера (когда Mac OS X
                автоматически очищает /tmp, а сетевой пакет перезагружается)
                </p>
            <codeblock>Xlib: connection to &quot;:0.0&quot; refused by
                server Xlib: Client is not authorized to connect to Server</codeblock>
            <p> Классификация ошибки: фатальная. Клиентские программы не могут установить соединение с
                сервером отображения (XDarwin), потому что используют ложные опознавательные данные.
                Ошибка может быть вызвана некоторыми инсталляциями VNC при запуске XDarwin
                через sudo и, вероятно, другими непонятными событиями. Обычное исправление
                состоит в удалении файла .Xauthority (хранящего опознавательные
                данные) в базовом каталоге и повторном создании
                пустого файла:</p>
            <codeblock>cd rm .Xauthority touch .Xauthority</codeblock>
            <!--
<codeblock>more error messages still to come...</codeblock>
-->
            <p> Еще одна распространенная причина отказов при запуске XFree86 -
                некорректный файл <filename>.xinitrc</filename>.
                Файл <filename>.xinitrc</filename> запускается и по какой-то причине
                практически сразу прекращает сеанс.<code>xinit</code>
                интерпретирует это как &quot;завершение сеанса пользователя&quot; (&quot;the user's session has
                ended&quot;) и уничтожает XDarwin. См. раздел <xref
                    section="xinitrc" chapter="run-xfree86">.xinitrc
                </xref> для получения более подробной информации. Не забудьте, что надо настроить PATH и
                иметь в распоряжении одну долговременную программу, которая запускается не на
                заднем плане. Хорошей идеей является добавление <code>exec xterm</code> для
                возврата в исходный режим, когда невозможно найти менеджер окон и т.п.</p>
            <!--
<p>
Some common problems that lead to this:
</p>
<ul>

<li><p>
All apps are started in the background.
Instead the last one must be started if the foreground (no
<code>&amp;</code> at the end of the line), or better with
<code>exec</code>.
</p></li>

<li><p>
The app that should run in the foreground can't be found.
This can happen when you give just the name without the path
(e.g. <code>xterm</code>), but forget to set the shell's search path
(environment variable PATH).
Neither /usr/X11R6/bin nor /opt/sw/bin are in the default path.
If you use Fink, just add an <code>source /opt/sw/bin/init.sh</code> to
the start of the <code>.xinitrc</code>.
To set the path manually, use this piece:
</p>
<codeblock>PATH=$PATH:/usr/X11R6/bin
export PATH</codeblock>
</li>

<li><p>
The app that should run in the foreground doesn't start or quits
immediately for some other reason.
There are many possibilities here, like missing libraries or missing
configuration files.
WindowMaker for instance requires that you run
<code>wmaker.inst</code> once before using it.
A good troubleshooting tactic in this situation is to replace the
forground app with <code>xterm</code> and launch it manually from the
xterm that comes up.
This way you can see diagnostic messages.
</p></li>

</ul>
<p>
Of course, there's always the last reason: a bug in XDarwin.
But most of the time, it really boils down to one of the above, even
when XDarwin crashes after some seconds.
</p>
-->
        </section>
        <section name="black">
            <title>Черные иконки на панели GNOME и в меню приложения GNOME</title>
            <p> Общая проблема заключается в том, что иконки и другие изображения имеют
                вид черных прямоугольников или контурных линий. Первоначально это было обусловлено
                ограничениями в ядре операционной системы. О проблеме сообщили
                Apple, но пока ее не исправили;
                более подробно см. <link
                    url="http://www.opensource.apple.com/bugs/X/Kernel/2691632.html">Отчеты об
                    ошибках в Darwin</link>.</p>
            <p> На данный момент ситуация такова, что расширение MIT-SHM протокола X11
                практически не используется в Darwin и Mac OS X. Есть
                два способа дезактивировать расширение протокола: на сервере
                и на клиенте. На серверах XFree86, инсталлированных при помощи Fink (т.e. пакетах
                xfree86-server и xfree86-rootless), оно уже дезактивировано.
                GIMP и панель GNOME также были модифицированы. 
                Если у вас есть черные иконки в другом приложении, запустите его
                с использованием опции строки команд <code>--no-xshm</code>.</p>
        </section>
        <section name="keyboard">
            <title>Клавиатура не работает в XFree86</title>
            <p> Это известная проблема, которая пока, насколько мы знаем, влияет только на
                портативные компьютеры (PowerBook, iBook). Раньше для ее решения использовалась опция
                раскладки клавиатуры &quot;Load from file&quot;.
                Сейчас она стала опцией по умолчанию, поскольку старый способ
                (считывание раскладки из ядра) перестал работать в
                Mac OS X 10.1. Если у вас эта опция не активирована,
                можно это сделать в диалоге параметров XDarwin. Надо отметить пункт
                &quot;Load from file&quot; и выделить файл раскладки клавиатуры для
                загрузки. После перезагрузки XDarwin ваша клавиатура
                должна функционировать лучше (см. текст далее).</p>
            <p> Если вы запускаете XFree86 со строки команд, можно перенести
                имя файла раскладки клавиатуры для загрузки в качестве опции, н-р:</p>
            <codeblock>startx -- -quartz -keymap USA.keymapping</codeblock>
        </section>
        <section name="delete-key">
            <title>Клавиша возврата (Backspace) не действует</title>
            <p> Это происходит, когда вы используете опцию &quot;Load keymapping from
                file&quot;, описанную выше. Файлы раскладки описывают
                клавишу Backspace как &quot;Delete&quot;, а не
                &quot;Backspace&quot;. Можно исправить положение, внеся
                следующую строку в файл .xinitrc:</p>
            <codeblock>xmodmap -e &quot;keycode 59 = BackSpace&quot;</codeblock>
            <p> Если не ошибаюсь, XDarwin 1.0a2 и более поздние версии имеют код,
                автоматически корректно отображающий эту клавишу.</p>
        </section>
        <section name="locale">
            <title>&quot;Warning: locale not supported by C library&quot;</title>
            <p> Подобные сообщения очень часты, но безобидны. Они означают только то, о чем
                сообщают - интернационализация не поддерживается стандартной библиотекой
                C и программа будет использовать по умолчанию английский язык для сообщений, форматов дат и т.п.
                Есть несколько способов реагирования на
                данную проблему:</p>
            <ul>
                <li>
                    <p> Просто не обращать на сообщения внимания.</p>
                </li>
                <li>
                    <p> Избавляться от сообщений, установив переменную величину среды
                        LANG в состояние "0". Имейте в виду, что это также отключит
                        интернационализацию в программах, которые ее поддерживают
                        (через gettext/libintl). Пример для .xinitrc:</p>
                    <codeblock>unset LANG</codeblock>
                    <p> Пример для .cshrc:</p>
                    <codeblock>unsetenv LANG</codeblock>
                </li>
                <li>
                    <p> (только для 10.1) Использовать пакет Fink <code>libxpg4</code>.
                        Он создает небольшую библиотеку с рабочими локальными
                        функциями и обеспечивает ее загрузку перед загрузкой системных
                        библиотек (с использованием переменной величины среды D_INSERT_LIBRARIES).
                        Возможно, вам надо будет установить переменную величину среды LANG
                        с полной точностью, н-р
                        <code>de_DE.ISO_8859-1</code> вместо <code>de</code>
                        или <code>de_DE</code>.</p>
                </li>
                <li>
                    <p> Обратиться к Apple с просьбой включить полную локальную поддержку
                        в следующую версию Mac OS X.</p>
                </li>
            </ul>
        </section>
    </chapter>
    <chapter filename="tips">
        <title>Подсказки по использованию</title>
        <shorttitle>Подсказки</shorttitle>
        <section name="terminal-app">
            <title>Запуск приложений X11 из окна Terminal.app</title>
            <p> Для запуска приложений X11из окна Terminal.app необходимо
                настроить переменную величину среды &quot;DISPLAY&quot;. Данная переменная
                сообщает приложению, где можно найти окно сервера X11.
                При настройке по умолчанию - когда  XDarwin запускается на одной машине
                - можно установить следующую настройку переменной:</p>
            <ul>
                <li>
                    <p>В случае использования tcsh:</p>
                    <codeblock>setenv DISPLAY :0.0</codeblock>
                </li>
                <li>
                    <p>В случае использования bash:</p>
                    <codeblock>export DISPLAY=":0.0"</codeblock>
                </li>
            </ul>
            <p> Хорошим решением является настройка, при которой XDarwin.app запускается при вашем входе в систему
                (настройку можно сделать на панели регистрации пользователей в параметрах системы в Mac OS
                10.2 и на панели счетов пользователей в пунктах запуска в Mac OS 10.3):</p>
            <ul>
                <li>
                    <p>При использовании tcsh надо добавить следующее к .cshrc:</p>
                    <codeblock>if (! $?DISPLAY) then setenv DISPLAY :0.0 endif</codeblock>
                </li>
                <li>
                    <p>При использовании bash надо добавить следующее к .bashrc:</p>
                    <codeblock>[[ -z $DISPLAY ]] &amp;&amp; export DISPLAY=":0.0"</codeblock>
                </li>
            </ul>
            <p> Таким образом DISPLAY настраивается в любой оболочке. При этом данная настройка не
                превалирует над текущим значением, если DISPLAY уже настроен.
                Таким образом  все еще можно запускать приложения X11 дистанционно или через
                ssh с туннелированием X11.</p>
        </section>
        <section name="open">
            <title>Запуск приложения Aqua apps из xterm</title>
            <p> Одним из способов запуска приложений Aqua из xterm (или любой другой
                оболочки) является команда <code>open</code>. Примеры:</p>
            <codeblock>open /Applications/TextEdit.app open SomeDocument.rtf
                open -a /Applications/TextEdit.app index.html</codeblock>
            <p> Во втором примере документ должен открываться в приложении, которое с ним связано;
                в третьем примере указано приложение, которое необходимо использовать.
                </p>
        </section>
        <section name="copy-n-paste">
            <title>Копирование (Copy) и вставка (Paste)</title>
            <p> Copy и Paste в основном работают между средами Aqua и X11.
                Все еще возникают некоторые ошибки. Есть жалобы о том, что Emacs
                слишком требователен в текущем выборе. Copy и Рaste не работают между Classic
                и X11.</p>
            <p> Так или иначе, решение заключается в использовании правильного способа
                в зависимости от имеющейся среды. Для переноса текста из Aqua в X11 используйте
                Cmd-C в Aqua, затем перенесите окно направления на передний план
                и для вставки примените &quot;среднюю клавишу мышки&quot; или
                Alt-щелчок, если у вас одноклавишная мышка (эту конфигурацию можно настроить
                в параметрах XDarwin). Для переноса текста из
                X11в Aqua просто выделите текст мышкой в X11, затем вставьте его
                при помощи Cmd-V в Aqua.</p>
            <p> В системе X11 есть несколько отдельных буферов обмена (называемых в X11
                &quot;cut buffers&quot;) и некоторые приложения не знают, какой из
                них следует использовать. В частности, по этой причине иногда не работает
                вставка в GNU Emacs или XEmacs.
                Программа <code>autocutsel</code> может в этом помочь;
                она автоматически синхронизирует два основных буфера для
                вырезанных объектов. Для ее запуска надо инсталлировать пакет Fink autocutsel и
                добавить следующую строку к .xinitrc:</p>
            <codeblock>autocutsel &amp;</codeblock>
            <p> (Она обязательно должна находиться <em>перед</em>строкой выполнения менеджера
                окна и никогда не должна быть на заднем плане! Не надо добавлять ее в конце - она просто не
                будет выполняться.) Запомните, что это больше не требуется для
                X11 Apple (см. <xref chapter="inst-xfree86"
                    section="apple-binary">Замечания об использовании X11 Apple</xref>).</p>
            <p>Если вы используете X11 Apple, можно применять Command-C или
                Edit-&gt;Copy, обычные для приложений Mac, для копирования текста в буфер,
                а среднюю клавишу мышки или Command-V для вставки
                из буфера в X11 Apple.</p>
            <p>В любом случае, если вы сталкиваетесь с проблемами копирования или вставки из
                Aqua в  X11 и наоборот, сначала надо попытаться сделать вставку дважды
                (иногда копия не получается при однократной попытке),
                затем использовать промежуточные приложения, н-р, TextEdit или
                Terminal.app для Aqua и nedit или xterm для X11.
                По моему опыту, всегда можно найти решение.</p>
        </section>
    </chapter>
</document>
